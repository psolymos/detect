<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Single-bin QPAD (SQPAD) — sqpad • detect</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single-bin QPAD (SQPAD) — sqpad"><meta name="description" content="Single bin QPAD (SQPAD) approach by Lele and Solymos (2025)."><meta property="og:description" content="Single bin QPAD (SQPAD) approach by Lele and Solymos (2025)."><script src="https://cdn.usefathom.com/script.js" data-site="KTMJHUPR" defer></script><link rel="icon" href="https://peter.solymos.org/favicon.ico"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">detect</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/peter-solymos/" aria-label="Linkedin"><span class="fa fa-linkedin"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/psolymos" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/psolymos" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Single-bin QPAD (SQPAD)</h1>

      <div class="d-none name"><code>sqpad.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Single bin QPAD (SQPAD) approach by Lele and Solymos (2025).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sqpad</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">dis</span>, <span class="va">dur</span>,</span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"approx"</span><span class="op">)</span>, det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"joint"</span>, <span class="st">"pq"</span><span class="op">)</span>,</span>
<span>    Nmax <span class="op">=</span> <span class="cn">NULL</span>, K <span class="op">=</span> <span class="cn">NULL</span>, A <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    montecarlo <span class="op">=</span> <span class="cn">FALSE</span>, np <span class="op">=</span> <span class="fl">1000</span>, distcorr <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sqpad.fit</span><span class="op">(</span><span class="va">Y</span>, <span class="va">dis</span>, <span class="va">dur</span>, X <span class="op">=</span> <span class="cn">NULL</span>, Z <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"approx"</span>, <span class="st">"conv"</span><span class="op">)</span>, det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"joint"</span>, <span class="st">"pq"</span><span class="op">)</span>,</span>
<span>    init <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    tt1 <span class="op">=</span> <span class="cn">NULL</span>, A <span class="op">=</span> <span class="cn">NULL</span>, Nmax <span class="op">=</span> <span class="cn">NULL</span>, K <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    montecarlo <span class="op">=</span> <span class="cn">FALSE</span>, np <span class="op">=</span> <span class="fl">1000</span>, distcorr <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, dislist <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'sqpad'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">digits</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'sqpad'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'sqpad'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'sqpad'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'sqpad'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'summary.sqpad'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">digits</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'sqpad'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, newdata <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"link"</span>, <span class="st">"response"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>formula, LHS takes a vector, RHS is either <code>1</code> or some covariates,
see Examples.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data.</p></dd>

  <dt id="arg-dis-dur">dis, dur<a class="anchor" aria-label="anchor" href="#arg-dis-dur"></a></dt>
<dd><p>a vector with distance and duration values.</p></dd>

  <dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>a vector with area values. Area is calculated from <code>dis</code>, use <code>A</code>
if distance is not directly related to area (e.g. for ARU data).</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>character, one of <code>"full"</code> (full likelihood), <code>"approx"</code> (approximate
method), and <code>"conv"</code> (convolution likelihood).</p></dd>

  <dt id="arg-det">det<a class="anchor" aria-label="anchor" href="#arg-det"></a></dt>
<dd><p>character, the detection model: <code>"joint"</code> or independence (<code>"pq"</code>).</p></dd>

  <dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>response vector, non-negative integers.</p></dd>

  <dt id="arg-x-z">X, Z<a class="anchor" aria-label="anchor" href="#arg-x-z"></a></dt>
<dd><p>design matrices, <code>X</code> is the matrix with covariates for the
density parameters. <code>Z</code> is the matrix with covariates for the cue rate model.
<code>NULL</code> means constant density and detection.</p></dd>

  <dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>truncation value, <code>K=1</code> implements the occupancy version of SQPAD.
<code>K&gt;1</code> implements the truncated count models.</p></dd>

  <dt id="arg-nmax">Nmax<a class="anchor" aria-label="anchor" href="#arg-nmax"></a></dt>
<dd><p>maximum abundance value for numerical integration under the full
and convolution likelihoods.</p></dd>

  <dt id="arg-montecarlo-np-distcorr">montecarlo, np, distcorr<a class="anchor" aria-label="anchor" href="#arg-montecarlo-np-distcorr"></a></dt>
<dd><p>should mean probability (<code>TRUE</code>) using <code>np</code> points or
approximation be used with distance correction <code>distcorr</code>
in the detection model.</p></dd>

  <dt id="arg-dislist">dislist<a class="anchor" aria-label="anchor" href="#arg-dislist"></a></dt>
<dd><p>distance list for the convolution likelihood.</p></dd>

  <dt id="arg-tt-">tt1<a class="anchor" aria-label="anchor" href="#arg-tt-"></a></dt>
<dd><p>vector with time to 1st detection values, same units as for <code>dur</code>.</p></dd>

  <dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>optional initial values for <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>method for <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>

  <dt id="arg-hessian">hessian<a class="anchor" aria-label="anchor" href="#arg-hessian"></a></dt>
<dd><p>logical, should the Hessian matrix be computed by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>.</p></dd>

  <dt id="arg-object-x">object, x<a class="anchor" aria-label="anchor" href="#arg-object-x"></a></dt>
<dd><p>fitted model object.</p></dd>

  <dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>optionally, a data frame in which to look for variables with which to predict.
If omitted, the fitted linear predictors are used.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>digits to use when providing summaries.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional options for <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> or the methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Single bin QPAD (SQPAD) approach for robust analysis of point count data
with detection error by Lele and Solymos (2025).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class 'sqpad'.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Solymos, P., Lele, S. R., 2025. Single bin QPAD (SQPAD) approach for robust
analysis of point count data with detection error.
<em>Ornithological Applications</em>, <b>xx</b>, xx–xx.</p>
<p>Supporting info for the SQPAD method:
<a href="https://github.com/psolymos/sqpad-paper" class="external-link">https://github.com/psolymos/sqpad-paper</a>,
&lt;doi:10.5281/zenodo.16172209&gt;.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Peter Solymos and Subhash Lele</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="va">n</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="va">n</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">dis</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span></span></span>
<span class="r-in"><span><span class="va">dcorr</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">dur</span> <span class="op">*</span> <span class="va">phi</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">dis</span><span class="op">*</span><span class="va">dcorr</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">tau</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">D</span><span class="op">*</span><span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">N</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sqpad(formula = y ~ x | 1, data = df, dis = dis, dur = dur, type = "full", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     det = "joint", K = NULL)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Single-bin QPAD model with dependence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full Maximum Likelihood estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     log.D_(Intercept)                log.D_x  log.delta_(Intercept)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -2.6490                 0.5793                 0.6531  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               log.phi  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -0.2066  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sqpad(formula = y ~ x | 1, data = df, dis = dis, dur = dur, type = "full", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     det = "joint", K = NULL)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Single-bin QPAD model with dependence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full Maximum Likelihood estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_(Intercept)      -2.6490     0.2559 -10.354  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_x                 0.5793     0.2028   2.857  0.00428 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.delta_(Intercept)   0.6531     1.2882   0.507  0.61218    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.phi                -0.2066     0.2579  -0.801  0.42313    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -61.23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC = 140.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     log.D_(Intercept)               log.D_x log.delta_(Intercept) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -2.6490003             0.5792880             0.6530735 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               log.phi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            -0.2065773 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       log.D_(Intercept)      log.D_x log.delta_(Intercept)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_(Intercept)           0.065460969 -0.016823675           -0.11176285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_x                    -0.016823675  0.041119454           -0.01041559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.delta_(Intercept)      -0.111762853 -0.010415590            1.65946169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.phi                     0.005060442  0.002226058           -0.29981181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            log.phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_(Intercept)      0.005060442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_x                0.002226058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.delta_(Intercept) -0.299811809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.phi                0.066510637</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_(Intercept)     -3.1504638 -2.1475368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.D_x                0.1818478  0.9767282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.delta_(Intercept) -1.8717539  3.1779010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log.phi               -0.7120453  0.2988906</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -61.23112 (df=4)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 130.4622</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 140.8829</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          5          6          7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.14699069 0.05854361 0.15279417 0.14779970 0.08992282 0.02898216 0.04129937 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8          9         10         11         12         13         14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05962214 0.07048600 0.28478709 0.11006769 0.04451822 0.03637679 0.05980405 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         15         16         17         18         19         20         21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05946710 0.05572181 0.08184809 0.04218547 0.09102563 0.03453122 0.06210579 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         22         23         24         25         26         27         28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08800342 0.07640095 0.11268680 0.06842058 0.09467870 0.13265186 0.04739391 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         29         30         31         32         33         34         35 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.03360255 0.07266231 0.06169562 0.05163844 0.05502257 0.04854658 0.10774345 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         36         37         38         39         40         41         42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.13783311 0.12565016 0.05514374 0.14490664 0.06015551 0.19579871 0.09786495 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         43         44         45         46         47         48         49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05440536 0.04367441 0.03598041 0.03814792 0.02858479 0.13820291 0.11452005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         50         51         52         53         54         55         56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.06199577 0.08251047 0.05685679 0.29090833 0.04461297 0.06850900 0.08174943 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         57         58         59         60         61         62         63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.10117947 0.06399188 0.01950120 0.03401353 0.08705693 0.07027081 0.04101132 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         64         65         66         67         68         69         70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.06613240 0.04410854 0.08137721 0.03097599 0.08742141 0.08166761 0.07344785 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         71         72         73         74         75         76         77 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.07151105 0.08209097 0.04855957 0.06600443 0.10390539 0.13382502 0.07686419 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         78         79         80         81         82         83         84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.06605857 0.04169598 0.03075272 0.04456775 0.14623724 0.11061411 0.06227700 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         85         86         87         88         89         90         91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05529417 0.05548123 0.12600196 0.06027998 0.14640132 0.10285967 0.15011940 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         92         93         94         95         96         97         98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.04264392 0.07106565 0.04245635 0.09989910 0.07580058 0.06005705 0.16438177 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         99        100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08075527 0.12596964 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         3         4         5         6         7         8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.917386 -2.837983 -1.878664 -1.911897 -2.408804 -3.541075 -3.186908 -2.819728 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         9        10        11        12        13        14        15        16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.652341 -1.256013 -2.206660 -3.111857 -3.313824 -2.816682 -2.822332 -2.887384 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        17        18        19        20        21        22        23        24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.502890 -3.165680 -2.396614 -3.365891 -2.778916 -2.430380 -2.571760 -2.183143 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        25        26        27        28        29        30        31        32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.682082 -2.357266 -2.020027 -3.049262 -3.393153 -2.621932 -2.785542 -2.963489 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        33        34        35        36        37        38        39        40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.900012 -3.025231 -2.228002 -1.981712 -2.074254 -2.897812 -1.931666 -2.810822 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        41        42        43        44        45        46        47        48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.630668 -2.324167 -2.911293 -3.130993 -3.324781 -3.266284 -3.554881 -1.979032 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        49        50        51        52        53        54        55        56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.167005 -2.780689 -2.494830 -2.867220 -1.234747 -3.109731 -2.680790 -2.504096 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        57        58        59        60        61        62        63        64 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.290859 -2.748999 -3.937279 -3.380997 -2.441193 -2.655399 -3.193907 -2.716097 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        65        66        67        68        69        70        71        72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.121102 -2.508660 -3.474543 -2.437015 -2.505098 -2.611180 -2.637903 -2.499927 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        73        74        75        76        77        78        79        80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.024964 -2.718033 -2.264274 -2.011222 -2.565715 -2.717214 -3.177351 -3.481777 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        81        82        83        84        85        86        87        88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.110745 -1.922525 -2.201708 -2.776163 -2.895088 -2.891710 -2.071458 -2.808755 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        89        90        91        92        93        94        95        96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.921404 -2.274390 -1.896324 -3.154871 -2.644151 -3.159279 -2.303595 -2.579649 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        97        98        99       100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.812460 -1.805564 -2.516332 -2.071714 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          5          6          7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.14699069 0.05854361 0.15279417 0.14779970 0.08992282 0.02898216 0.04129937 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8          9         10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.05962214 0.07048600 0.28478709 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         3         4         5         6         7         8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.917386 -2.837983 -1.878664 -1.911897 -2.408804 -3.541075 -3.186908 -2.819728 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         9        10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.652341 -1.256013 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span> <span class="co"># m2 is best</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">m0</span>, <span class="va">m1</span>, <span class="va">m2</span><span class="op">)</span> <span class="co"># this is needed!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># average probability</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="va">n</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="va">n</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">dis</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dcorr</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">dur</span> <span class="op">*</span> <span class="va">phi</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">dis</span><span class="op">*</span><span class="va">dcorr</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">tau</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">D</span><span class="op">*</span><span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">N</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">np</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">dij</span> <span class="op">&lt;-</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Triangular.html" class="external-link">rtriang</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">np</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dij</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">dij</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">np</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">dur</span> <span class="op">*</span> <span class="va">phi</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">dis</span><span class="op">*</span><span class="va">dij</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">tau</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">N</span>, <span class="va">p2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">Y2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">p2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mAP</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, </span></span>
<span class="r-in"><span>    det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span>, montecarlo <span class="op">=</span> <span class="cn">FALSE</span>, hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mMC</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, </span></span>
<span class="r-in"><span>    det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span>, montecarlo <span class="op">=</span> <span class="cn">TRUE</span>, hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2AP</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df2</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, </span></span>
<span class="r-in"><span>    det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span>, montecarlo <span class="op">=</span> <span class="cn">FALSE</span>, hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2MC</span> <span class="op">&lt;-</span> <span class="fu">sqpad</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df2</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, type <span class="op">=</span> <span class="st">"full"</span>, </span></span>
<span class="r-in"><span>    det <span class="op">=</span> <span class="st">"joint"</span>, K <span class="op">=</span> <span class="cn">NULL</span>, montecarlo <span class="op">=</span> <span class="cn">TRUE</span>, hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>mAP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mAP</span><span class="op">)</span>, mMC<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mMC</span><span class="op">)</span>, m2AP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m2AP</span><span class="op">)</span>, m2MC<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m2MC</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convolution likelihood</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="va">n</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">2</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="va">n</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">dis</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">D</span><span class="op">*</span><span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dislist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">dij</span> <span class="op">&lt;-</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Triangular.html" class="external-link">rtriang</a></span><span class="op">(</span><span class="va">N</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="va">dis</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">dis</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># pij is based on time of 1st detection and distance at 1st detection</span></span></span>
<span class="r-in"><span>    <span class="va">pij</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">dur</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">phi</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">dij</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">tau</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">Yij</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pij</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">pij</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">dij</span><span class="op">[</span><span class="va">Yij</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">dis</span>, <span class="va">length</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">sqpad.fit</span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, dis <span class="op">=</span> <span class="va">dis</span>, dur <span class="op">=</span> <span class="va">dur</span>, dislist <span class="op">=</span> <span class="va">dislist</span>, </span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="st">"conv"</span>, det <span class="op">=</span> <span class="st">"joint"</span>, Nmax <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">D</span>, phi <span class="op">=</span> <span class="va">phi</span>, tau <span class="op">=</span> <span class="va">tau</span><span class="op">)</span>, estimates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">m4</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Peter Solymos, Monica Moreno, Subhash R. Lele.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

